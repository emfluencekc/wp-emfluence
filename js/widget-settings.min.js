emfluenceEmailerWidget={init:function(){($container=jQuery(".wp-emfluence")).accordion({heightStyle:"content",collapsible:!0,active:!1}),jQuery(".wp-emfluence .type-selector").each(function(e,t){emfluenceEmailerWidget.fields.typeSelected(jQuery(t).parents(".type-section"))}),$container.on("change",".type-selector",function(){emfluenceEmailerWidget.fields.typeSelected(jQuery(this).parents(".type-section"))}),emfluenceEmailerWidget.initValidationRedirectField()},initValidationRedirectField:function(){var e=jQuery(".wp-emfluence .redirect-url");e.change(function(){var e=jQuery(this);""===e.val()||emfluenceEmailerWidget.validURL(e.val())?e.siblings(".validation-error").remove():0===e.siblings(".validation-error").length&&e.after('<span class="validation-error">Invalid URL format</span>')}),e.keyup(function(){var e=jQuery(this);0!==e.siblings(".validation-error").length&&(""===e.val()||emfluenceEmailerWidget.validURL(e.val()))&&e.siblings(".validation-error").remove()}),e.each(function(){var e=jQuery(this);0!==e.siblings(".validation-error").length||""===e.val()||emfluenceEmailerWidget.validURL(e.val())||e.after('<span class="validation-error">Invalid URL format</span>')})},validURL:function(e){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)},groups:{add:function(e){$widget=jQuery(e).parents(".widget"),$input=this.getInput($widget),$groupIdsContainer=this.getGroupIdsContainer($widget);var t=this.processValue($input.val());if(t){if(($checkboxesContainer=this.getCheckboxesContainer($widget)).find('input[type="checkbox"][value="'+t.id+'"]').length>0){alert(t.name+" is already in the selected groups.");return}$checkboxesContainer.append(this.createCheckbox($widget,t)),0===$groupIdsContainer.val().length?$groupIdsContainer.val(t.id):$groupIdsContainer.val($groupIdsContainer.val()+","+t.id),$input.val(null)}},removeGroup:function(e){$widget=jQuery(e).parents(".widget"),$groupIdsContainer=this.getGroupIdsContainer($widget),$currentGroupId=jQuery(e).attr("value"),$groupIdsArray=$groupIdsContainer.val().split(","),jQuery(e).is(":checked")?$groupIdsArray.push($currentGroupId):$groupIdsArray=jQuery.grep($groupIdsArray,function(e){return e!=$currentGroupId}),$commaString=$groupIdsArray.join(","),$groupIdsContainer.val($commaString)},getInput:function(e){return e.find(".groups input[list]")},getCheckboxesContainer:function(e){return e.find(".groups .selected")},getGroupIdsContainer:function(e){return e.find(".begroups")},processValue:function(e){var t=e.match(/(.+)\s\[(\d+)\]/);return!!t&&{name:t[1],id:t[2]}},createCheckbox:function(e,t){var i="",n="";try{i=e.attr("id").slice(-1),n="groups-"+i+"-"+t.id}catch{i="widget-7_emfluence_email_signup-"+(instance_number=jQuery("#emfluence_email_signup_instance").val()).slice(-1),n="groups-"+instance_number+"-"+t.id}return'<div><label for="'+n+'">          <input id="'+n+'" type="checkbox" value="'+t.id+'" name="groups[]" checked /> '+t.name+"        </label></div>"}},fields:{add:function(e){$widget=jQuery(e).parents(".widget");var t=($input=this.getInput($widget)).val(),i=$input.find("option:selected").data("settings");if(!t||!i)return console.error("Field not found.");if(($container=this.getContainer($widget)).find('[data-variable-key="'+t+'"]').length>0){alert(i.name+" is already in the selected contact fields.");return}$container.append(this.createSection($widget,t,i)),$input.val(null)},getInput:function(e){return e.find(".basic-fields-adder select")},getContainer:function(e){return e.find(".basic_contact_fields")},getCustomTemplate:function(e){return e.find(".basic_contact_field_template").html()},createSection:function(e,t,i){var n=1;return e.find(".basic_contact_fields .contact-field input.order").each(function(e,t){var i=parseInt(t.value);isNaN(i)||(n=Math.max(n,i))}),this.getCustomTemplate(e).replace(RegExp("CONTACT_FIELD_NAME","g"),i.name).replace(RegExp("CONTACT_FIELD_KEY","g"),t).replace(RegExp("CONTACT_FIELD_REQUIRED_MESSAGE","g"),i.required_message).replace(RegExp("CONTACT_FIELD_LABEL","g"),i.label).replace(RegExp("CONTACT_FIELD_ORDER","g"),n+1)},typeSelected:function(e){var t=e.find(".type-selector option:selected").text();e.find(".hidden-value").hide(),"hidden"===t&&e.find(".hidden-value").show()}},variables:{add:function(e){$widget=jQuery(e).parents(".widget");var t=($input=this.getInput($widget)).val();if(t){if(($customVariablesContainer=this.getCustomVariablesContainer($widget)).find('[data-variable-key="custom_'+t+'"]').length>0){alert(t+" is already in the selected custom variables.");return}$customVariablesContainer.append(this.createVariableSection($widget,t)),$input.val(null)}},getInput:function(e){return e.find(".custom-variable-adder input")},getCustomVariablesContainer:function(e){return e.find(".custom_variables")},getCustomVariablesTemplate:function(e){return e.find(".custom_variable_template").html()},createVariableSection:function(e,t){return this.getCustomVariablesTemplate(e).replace(RegExp("CUSTOM_VARIABLE_NUMBER","g"),t)}}},jQuery(function(){$=jQuery,emfluenceEmailerWidget.init(),$(document).ajaxSuccess(emfluenceEmailerWidget.init)});